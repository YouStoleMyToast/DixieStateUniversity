%
% Assignment 4c for CS3530 Computational Theory:
% Context-free Grammars and Pushdown Automata
% Fall 2014
%
% Problems taken from Sipser
%

\documentclass{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{ae,aecompl}
\usepackage{emp,ifpdf}
\usepackage{graphicx}
\usepackage{enumerate}

\ifpdf\DeclareGraphicsRule{*}{mps}{*}{}\fi

\empaddtoTeX{\usepackage{amsmath}}
\empprelude{input boxes; input theory}

% skip for paragraphs, don't indent
\parskip 6pt plus 1pt
\parindent=0pt
\raggedbottom

% a list environment with no bullets or numbers
\newenvironment{indentlist}{\begin{list}{}{\addtolength{\itemsep}{0.5\baselineskip}}}{\end{list}}

\begin{document}
\begin{empfile}

\begin{center}
\textbf{\Large CS 3530: Assignment 4c} \\[2mm]
Fall 2014
\end{center}

\raggedright

\section*{Problems}

\subsection*{Problem 2.24 (10 points)}

\subsubsection*{Problem}

Let $E=\{a^i b^j: i\neq j$ and $2i\neq j\}$. Show that $E$ is a
context-free language.

If you give a CFG, describe the role that each rule performs as well
as giving the actual rule. If you give a PDA, describe how it works
as well as giving the state diagram.

\subsubsection*{Solution}

I broke up the problem into two PDAs and concatenated them since that fits 
the closure property. The top PDA covers $2i\neq j$ where the top path takes 
care of 2i < j while the bottom path takes care of 2i > j. The bottom PDA 
covers $i\neq j$ where the top path takes care of i > j while the bottom 
path takes care of i < j.


\begin{center}
\begin{emp}(0,0)
	a := 3cm;
	b := a*2;
	c := a*3;
	d := a*4;
	x := a/2;
	y := 2a/3;
	t := 3.5cm;
	u := 2*t;
	%first part
	node.q0("q0"); q0.c = origin;
	node.q1("q1"); q1.c = q0.c + (a,0);
	node.q2("q2"); q2.c = q0.c + (b,x);
	node.q3("q3"); q3.c = q0.c + (c,x);
	node.q4("q4"); q4.c = q0.c + (d,0);
	node.q5("q5"); q5.c = q0.c + (b,-x);
	node.q6("q6"); q6.c = q0.c + (c,-x);

	smallnodes; node.q99(); q99.c = q0.c + (a,y); bignodes;
	tinynodes; node.q100(); q100.c = q0.c + (u,-u+t); bignodes;
	%second part
	node.q7("q7"); q7.c = q0.c + (0,-u);
	node.q8("q8"); q8.c = q0.c + (a,-u);
	node.q9("q9"); q9.c = q0.c + (b,-u+x);
	node.q10("q10"); q10.c = q0.c + (c,-u+x);
	node.q11("q11"); q11.c = q0.c + (b,-u-x);
	node.q12("q12"); q12.c = q0.c + (c,-u-x);
	node.q13("q13"); q13.c = q0.c + (d,-u);
	
	
	makestart(q0);
	makefinal(q13);

	drawboxed(q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q99);
	
	undirectededges; edge(q4,q100,40,""); directededges;
	edge(q100,q7,-30,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	
	%first part
	edge(q0,q1,right,btex $(\varepsilon,\varepsilon)\rightarrow \$ $ etex);
	edge(q1,q99,40,btex $(a,\varepsilon)\rightarrow a $ etex);
	edge(q99,q1,40,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	
	edge(q1,q2,right,btex $(b,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q2,q3,left,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q3,q4,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);


	loop(q2,up,btex $(b,\varepsilon)\rightarrow \varepsilon $ etex);
	loop(q3,up,btex $(b,a)\rightarrow \varepsilon $ etex);
	
	edge(q1,q5,left,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q5,q6,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q6,q4,left,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);
	
	loop(q5,down,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	loop(q6,down,btex $(b,a)\rightarrow \varepsilon $ etex);
	
	%second part
	edge(q7,q8,right,btex $(\varepsilon,\varepsilon)\rightarrow \$ $ etex);
	loop(q8,up,btex $(a,\varepsilon)\rightarrow a $ etex);
	
	edge(q8,q9,right,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q9,q10,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q10,q13,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	loop(q9,up,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	loop(q10,up,btex $(b,a) \rightarrow \varepsilon $ etex);
	
	edge(q8,q11,left,btex $(b,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q11,q12,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q12,q13,left,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	loop(q11,down,btex $(b,\varepsilon) \rightarrow \varepsilon $ etex);
	loop(q12,down,btex $(b,a)\rightarrow \varepsilon $ etex);
	
	
\end{emp}
\end{center}

$\newline$

\begin{center}
\begin{emp}(0,0)
	a := 3cm;
	b := a*2;
	c := a*3;
	d := a*4;
	x := a/2;

	node.q0("q0"); q0.c = origin;
	node.q1("q1"); q1.c = q0.c + (a,0);
	
	node.q2("q2"); q2.c = q0.c + (b,x);
	node.q3("q3"); q3.c = q0.c + (c,x);
	
	node.q5("q5"); q5.c = q0.c + (b,-x);
	node.q6("q6"); q6.c = q0.c + (c,-x);
	
	node.q4("q4"); q4.c = q0.c + (d,0);
	
	
	makestart(q0);
	makefinal(q4);

	drawboxed(q0,q1,q2,q3,q4,q5,q6);

	edge(q0,q1,right,btex $(\varepsilon,\varepsilon)\rightarrow \$ $ etex);
	loop(q1,up,btex $\hspace*{-1cm}(a,\varepsilon)\rightarrow a $ etex);
	
	
	edge(q1,q2,right,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q2,q3,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q3,q4,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	loop(q2,up,btex $(a,\varepsilon)\rightarrow \varepsilon $ etex);
	loop(q3,up,btex $(b,a) \rightarrow \varepsilon $ etex);
	
	edge(q1,q5,right,btex $(b,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q5,q6,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q6,q4,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	loop(q5,down,btex $(b,\varepsilon) \rightarrow \varepsilon $ etex);
	loop(q6,down,btex $(b,a)\rightarrow \varepsilon $ etex);
	
	
\end{emp}
\end{center}

$\newline$
concat
\begin{center}
\begin{emp}(0,0)
	a := 3cm;
	b := a*2;
	c := a*3;
	d := a*4;
	e := a*5;
	f := a*6;
		
	node.q0("q0"); q0.c = origin;
	node.q1("q1"); q1.c = q0.c + (a,0);
	node.q2("q2"); q2.c = q0.c + (b,0);
	node.q3("q3"); q3.c = q0.c + (c,0);
	smallnodes; node.q4(); q4.c = q0.c + (a,a/2); bignodes;
	
	node.q5("q5"); q5.c = q0.c + (b,-a);
	node.q6("q6"); q6.c = q0.c + (c,-a);
	node.q7("q7"); q7.c = q0.c + (d,-a);
	node.q8("q8"); q8.c = q0.c + (e,-a);
	
	makestart(q0); makefinal(q8);

	drawboxed(q0,q1,q2,q3,q4,q5,q6,q7,q8);

	edge(q0,q1,right,btex $(\varepsilon,\varepsilon)\rightarrow \$ $ etex);
	edge(q1,q2,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q2,q3,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	edge(q1,q4,60,btex $(a,\varepsilon)\rightarrow a $ etex);
	edge(q4,q1,60,btex $(a,\varepsilon)\rightarrow a $ etex);
	
	loop(q2,up,btex $(b,a)\rightarrow \varepsilon $ etex);
	
	
	edge(q3,q5,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	
	
	edge(q5,q6,right,btex $(\varepsilon,\varepsilon)\rightarrow \$ $ etex);
	edge(q6,q7,right,btex $(\varepsilon,\varepsilon)\rightarrow \varepsilon $ etex);
	edge(q7,q8,right,btex $(\varepsilon,\$)\rightarrow \varepsilon $ etex);

	loop(q6,up,btex $(a,\varepsilon)\rightarrow a $ etex);
	loop(q7,up,btex $(b,a)\rightarrow \varepsilon $ etex);
	
\end{emp}
\end{center}

\subsection*{Problem 2.44 (10 points)}

\subsubsection*{Problem}

If $A$ and $B$ are languages, define $A\diamond B=\{xy:x\in A$ and
$y\in B$ and $|x|=|y|\}$. Show that if $A$ and $B$ are regular
languages, then $A\diamond B$ is a CFL.

Note: a formal proof is not necessary; a detailed description of a
suitable construction will suffice.

\subsubsection*{Solution}

\end{empfile}
\immediate\write18{mpost -tex=latex \jobname}
\end{document}
